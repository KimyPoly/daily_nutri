
class Parser

  def initialize(string)
    @test
    @recipes = string || "Sure! Here are 12 vegan recipes that can help you in your weight loss journey:\n\n1. Recipe's title: Lemon Garlic Roasted Brussels Sprouts\n   Calories: 120 calories\n   Type: Side Dish\n   Time: 30 minutes\n   Price: $3-4\n   Ingredients: Brussels sprouts, lemon juice, garlic, olive oil, salt, pepper\n   Recipe: Preheat the oven to 400°F (200°C). Trim and halve the Brussels sprouts. In a bowl, mix lemon juice, minced garlic, olive oil, salt, and pepper. Toss the Brussels sprouts in the mixture. Roast in the oven for 25 minutes, until crispy.\n\n2. Recipe's title: Chickpea Salad\n   Calories: 250 calories\n   Type: Lunch\n   Time: 15 minutes\n   Price: $4-5\n   Ingredients: Chickpeas, cucumber, cherry tomatoes, red onion, parsley, lemon juice, olive oil, salt, pepper\n   Recipe: Rinse and drain chickpeas. Chop cucumber, cherry tomatoes, and red onion. In a bowl, combine all ingredients and toss with lemon juice, olive oil, salt, and pepper.\n\n3. Recipe's title: Quinoa Stuffed Bell Peppers\n   Calories: 300 calories\n   Type: Dinner\n   Time: 45 minutes\n   Price: $5-6\n   Ingredients: Bell peppers, quinoa, black beans, corn, onion, garlic, cumin, paprika, salt, pepper\n   Recipe: Preheat the oven to 375°F (190°C). Cut the tops off bell peppers and remove seeds. In a pan, sauté onion and garlic. Add cooked quinoa, black beans, corn, cumin, paprika, salt, and pepper. Stuff the bell peppers with the mixture. Bake for 30 minutes.\n\n4. Recipe's title: Vegan Lentil Soup\n   Calories: 180 calories\n   Type: Soup\n   Time: 1 hour\n   Price: $4-5\n   Ingredients: Lentils, vegetable broth, carrots, celery, onion, garlic, turmeric, cumin, paprika, salt, pepper\n   Recipe: In a pot, sauté onion, garlic, carrots, and celery. Add lentils, vegetable broth, turmeric, cumin, paprika, salt, and pepper. Simmer for 45 minutes until lentils are tender.\n\n5. Recipe's title: Avocado and Black Bean Wrap\n   Calories: 320 calories\n   Type: Lunch\n   Time: 10 minutes\n   Price: $4-5\n   Ingredients: Whole wheat tortilla, avocado, black beans, corn, red onion, lettuce, salsa\n   Recipe: Mash avocado. Spread it on a tortilla. Add black beans, corn, sliced red onion, lettuce, and salsa. Roll it up into a wrap.\n\n6. Recipe's title: Vegan Stir-Fry\n   Calories: 280 calories\n   Type: Dinner\n   Time: 20 minutes\n   Price: $6-7\n   Ingredients: Tofu, broccoli, bell peppers, carrots, mushrooms, soy sauce, garlic, ginger, sesame oil\n   Recipe: Press tofu to remove excess water and cube it. Stir-fry tofu, broccoli, bell peppers, carrots, and mushrooms in sesame oil. Add soy sauce, minced garlic, and grated ginger. Cook until vegetables are tender.\n\n7. Recipe's title: Vegan Banana Oat Pancakes\n   Calories: 220 calories\n   Type: Breakfast\n   Time: 25 minutes\n   Price: $3-4\n   Ingredients: Rolled oats, ripe bananas, plant-based milk, maple syrup, vanilla extract\n   Recipe: Blend rolled oats to make flour. Mash bananas and mix with oat flour, plant-based milk, maple syrup, and vanilla extract. Cook the batter on a non-stick pan to make pancakes.\n\n8. Recipe's title: Mediterranean Quinoa Salad\n   Calories: 280 calories\n   Type: Lunch\n   Time: 20 minutes\n   Price: $5-6\n   Ingredients: Quinoa, cucumber, cherry tomatoes, red onion, Kalamata olives, parsley, lemon juice, olive oil, salt, pepper\n   Recipe: Cook quinoa according to package instructions. Chop cucumber, cherry tomatoes, red onion, and olives. In a bowl, mix cooked quinoa, vegetables, parsley, lemon juice, olive oil, salt, and pepper.\n\n9. Recipe's title: Vegan Lentil Bolognese\n   Calories: 320 calories\n   Type: Dinner\n   Time: 40 minutes\n   Price: $5-6\n   Ingredients: Lentils, spaghetti, crushed tomatoes, onion, garlic, carrot, celery, oregano, basil, salt, pepper\n   Recipe: Sauté onion, garlic, carrot, and celery. Add cooked lentils, crushed tomatoes, oregano, basil, salt, and pepper. Simmer for 30 minutes. Serve over cooked spaghetti.\n\n10. Recipe's title: Roasted Butternut Squash Soup\n    Calories: 200 calories\n    Type: Soup\n    Time: 1 hour\n    Price: $4-5\n    Ingredients: Butternut squash, vegetable broth, onion, garlic, nutmeg, cinnamon, salt, pepper\n    Recipe: Preheat the oven to 400°F (200°C). Cut butternut squash in half, remove seeds, and roast for 45 minutes. Sauté onion and garlic. Scoop out roasted squash and add it to the pot along with vegetable broth, nutmeg, cinnamon, salt, and pepper. Blend until smooth.\n\n11. Recipe's title: Vegan Berry Smoothie Bowl\n    Calories: 250 calories\n    Type: Breakfast\n    Time: 10 minutes\n    Price: $4-5\n    Ingredients: Frozen mixed berries, banana, almond milk, chia seeds, granola, shredded coconut\n    Recipe: Blend frozen mixed berries, banana, and almond milk until smooth. Pour into a bowl and top with chia seeds, granola, and shredded coconut.\n\n12. Recipe's title: Vegan Black Bean Burgers\n    Calories: 280 calories\n    Type: Dinner\n    Time: 45 minutes\n    Price: $6-7\n    Ingredients: Black beans, onion, garlic, bell peppers, oats, cumin, paprika, salt, pepper\n    Recipe: Mash black beans and mix with sautéed onion, garlic, and bell peppers. Add oats, cumin, paprika, salt, and pepper. Form into patties and cook on a non-stick pan until browned on each side.\n\nPlease note that the calorie counts are approximate and can vary based on specific ingredients and portion sizes. Adjust the recipes according to your taste preferences and dietary needs. Enjoy your vegan weight loss journey!"
  end
  def parse_recipes(text)
    puts "ChatGPT answer:"
    puts text
    results = []
    regex = /@@ name @@ @@@ (.*?) @@@.*?@@ Calories @@ @@@ (.*?) @@@.*?@@ Type @@ @@@ (.*?) @@@.*?@@ Time @@ @@@ (.*?) @@@.*?@@ Price @@ @@@ (.*?) @@@.*?@@ Ingredients @@ @@@ (.*?) @@@.*?@@ Recipe @@ @@@ (.*?) @@@/m

    results = text.scan(regex).map do |name, calories, meal_type, time, price, ingredients, instructions|
      {
        name: name.strip,
        calories: calories.strip,
        meal_type: meal_type.strip,
        time: time.strip,
        price: price.strip,
        ingredients: ingredients.strip.split(', ').map(&:strip),
        instructions: instructions.strip
      }
    end

    p results
    results
  end
end
