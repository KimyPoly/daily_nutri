
<% d = Time.now.day%>
<% m = Time.now.month%>
<% y = Time.now.year %>
<% m31 = [1,3,5,7,8,10,12] %>
<% fev = 2 %>
<% we = (d..d + 6).to_a %>

<%if m31.include?(m)%>
  <% we.map! { |valeur| valeur > 31 ? valeur -= 31 : valeur } %>
<%  elsif m == fev %>
    <% if y/4 == Integer %>
      <% we.map! { |valeur| valeur > 29 ? valeur -= 29 : valeur } %>
    <% else %>
      <% we.map! { |valeur| valeur > 28 ? valeur -= 28 : valeur } %>
    <% end %>
<% else %>
  <% we.map! { |valeur| valeur > 30 ? valeur -= 30 : valeur } %>
<% end %>
<div class="bubble_list">
  <% we.each do |day| %>
    <div class="bubble_container"><a class="calendar_bubble" href="http://127.0.0.1:3000/dashboard"><%= day %></a></div>
  <% end %>
</div>



<div class="btn-back-and-groceries">
  <i class="fa-solid fa-backward"><%= link_to "Back", dashboard_path, class: "" %></i>
  <i class="fa-solid fa-cart-shopping"><%= link_to "Groceries list", "#", class: "" %></i>

</div>

<br>
<br>

<div class="container">

  <div class="meal-container">
  <% @meals.each do |meal| %>
    <p>Program ID: <%= meal.programs.first.id %>
    <%= meal.name %>
  <% end %>

  <h3><strong>Breakfast</strong></h3>
  <div class="meal-card">
  <div class="img-container" style="background-image: url('https://breakfast-in-america.com/wp-content/uploads/2023/06/BreakfastinAmerica_Pancakes.webp')"></div>
     <div class="meal-card-info img-meal" style="background-image: linear-gradient(rgba(0,0,0,0.5), rgba(0,0,0,0.5)), url('https://breakfast-in-america.com/wp-content/uploads/2023/06/BreakfastinAmerica_Pancakes.webp'); width: 100%; height: 100%;">

      <% found_breakfast = false %>
      <% @meals.each do |meal| %>
        <% if meal.meal_type == "breakfast" && !found_breakfast %>
        <% found_breakfast = true %>
          <ul>
            <li><span>üçΩÔ∏è</span> <%= link_to meal.name, meal_path(meal) %></li>
            <li><span>‚åõ</span> <%= meal.time %></li>
          </ul>


        <% end %>
      <% end %>
    </div>
  </div>

  <h3><strong>Lunch</strong></h3>
  <div class="meal-card">
  <div class="img-container" style="background-image: url('https://www.acouplecooks.com/wp-content/uploads/2022/01/Hummus-Bowl-016.jpg')"></div>
   <div class="meal-card-info img-meal" style="background-image: linear-gradient(rgba(0,0,0,0.5), rgba(0,0,0,0.5)), url('https://www.acouplecooks.com/wp-content/uploads/2022/01/Hummus-Bowl-016.jpg'); width: 100%; height: 100%;">

    <% found_dish = false %>
    <% @meals.each_with_index do |meal, index| %>
      <% next if index.even? %>
        <% if meal.meal_type == "dish" && !found_dish %>
          <% found_dish = true %>
          <ul>
            <li><span>üçΩÔ∏è</span> <%= link_to meal.name, meal_path(meal) %></li>
            <li><span>‚åõ</span> <%= meal.time %></li>
          </ul>

        <% end %>
      <% end %>
     </div>
    </div>


    <h3><strong>Diner</strong></h3>
    <div class="meal-card">
    <div class="img-container" style="background-image: url('https://cache.marieclaire.fr/data/photo/w1000_ci/6g/lasagnes-aux-3-viandes-pate-maison.jpg')"></div>
    <div class="meal-card-info img-meal" style="background-image: linear-gradient(rgba(0,0,0,0.5), rgba(0,0,0,0.5)), url('https://cache.marieclaire.fr/data/photo/w1000_ci/6g/lasagnes-aux-3-viandes-pate-maison.jpg'); width: 100%; height: 100%;">
      <% found_dish = false %>
      <% @meals.each_with_index do |meal, index| %>
      <% next if index.odd? %>
        <% if meal.meal_type == "dish" && !found_dish %>
          <% found_dish = true %>
          <ul>
            <li><span>üçΩÔ∏è</span> <%= link_to meal.name, meal_path(meal) %></li>
            <li><span>‚åõ</span> <%= meal.time %></li>

          </ul>
        <% end %>
      <% end %>
          </div>
  </div>
    </div>


  <div data-controller="toggle">
    <button data-action="click->toggle#action" class="btn-home">Edit</button>
    <div class="display-none" data-toggle-target="form">
    <%= render partial: 'shared/form_new', locals: { program: @program } %>
  </div>
